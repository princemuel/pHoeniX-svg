---
import { getCollection } from "astro:content";
import Navlink from "@/components/atoms/navlink.astro";
import { tw } from "@/utilities/strings";
import { Icon } from "astro-icon/components";
import type { HTMLAttributes } from "astro/types";

type Props = HTMLAttributes<"menu">;

// "about" | "articles" | "blog" | "dashboard" | "home" | "projects" | "resources"
const excludedRoutes = ["resources", "articles", "blog"];
const routes = await getCollection(
  "routes",
  (data) => !excludedRoutes.includes(data.id),
);
---

<menu
  {...Astro.props}
  role="menu"
  aria-orientation="horizontal"
  class={tw([
    "flex rounded-pill px-3",
    "text-sm font-medium text-gray-800 dark:text-gray-50",
    "bg-gray-50/5 ring-1 ring-gray-900/5 dark:ring-white/10",
    "shadow-lg shadow-gray-800/5 backdrop-blur-xl",
  ])}
>
  {
    routes.map((route) => (
      <li role="presentation" class="capitalize">
        <Navlink
          role="menuitem"
          class="group relative flex px-3 py-2 transition aria-[current=page]:text-gray-600 hocus:text-gray-600 dark:aria-[current=page]:text-gray-500 dark:hocus:text-gray-500"
          href={route.data.href}
        >
          <Icon
            name={route.data.icon}
            class="text-lg text-inherit sm:text-xl md:hidden"
          />
          <span class="sr-only text-inherit md:not-sr-only">
            {route.data.text}
          </span>
          <span class="absolute inset-x-1 -bottom-px hidden h-px bg-gradient-to-r from-gray-600/0 via-gray-600/40 to-gray-600/0 group-aria-[current=page]:inline dark:from-gray-500/0 dark:via-gray-500/40 dark:to-gray-500/0" />
        </Navlink>
      </li>
    ))
  }
</menu>
